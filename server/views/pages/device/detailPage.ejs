<!DOCTYPE html>
<html>

<head>
    <title>welcome Test IOF</title>
    <% include ../../partials/stylesheet.ejs %>
    <% include ../../partials/header_javascript.ejs %>
    <% include ../../partials/weather_config.ejs %>
</head>


<body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">
        <header class="main-header">
            <!-- Logo -->
            <a href="/" class="logo">
                <!-- mini logo for sidebar mini 50x50 pixels -->
                <span class="logo-mini"><b>I</b>OF</span>
                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg"><b>C &amp; H </b>IOF</span>
            </a>
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top">
                <!-- Sidebar toggle button-->
                 <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                        <span class="sr-only">Toggle navigation</span>
                </a>
                <div class="navbar-custom-menu">
                    <ul class="nav navbar-nav">
                        <!-- Tasks: style can be found in dropdown.less -->
                        <!-- header nav 들어가는 부분 -->
                    </ul>
                </div>
            </nav>
        </header>
        <!-- Left side column. contains the logo and sidebar -->
        <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">
                <!-- Sidebar user panel -->
                <div class="user-panel">
                    <div class="pull-left image">
                        <img src="/static/images/logo_iot.png" class="img-circle" alt="User Image">
                    </div>
                    <div class="pull-left info">
                        
                        <!-- <a href="#"><i class="fa fa-circle text-success"></i> Online</a> -->
                    </div>
                </div>
                <!-- nav item -->
                <% include ../../partials/nav_item %>
                <!-- end nav item -->
            </section>
            <!-- /.sidebar -->
        </aside>
        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
                <!-- Content Header (Page header) -->
                 <section class="content-header">
                    <h1>
                        Device <small>serial num or name</small>
                    </h1>
                    <ol class="breadcrumb">
                        <li><a href="/"><i class="fa fa-dashboard"></i> Home</a></li>
                        <li><i class="ffa fa-dshboard"></i><a href="/device/list">device</a></li>
                        <li class="active"><a href="#">detail</a></li>
                    </ol>
                </section> 
                <div class="content">
                    <div class="callout callout-info">
                    <h4>Device detail</h4>
                    <p>
                        how to use and show data detail subscript
                    </p>
                    </div>
                    <div class="row">
                    <!-- col md 6 start -->
                        <div class="col-xs-12">
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <i class="fa fa-bar-chart-o"></i>
                                    <h3 class="box-title">show data</h3>
                                </div>
                                <!-- box header end -->
                                <div class="box-body">
                                    <div id="line-chart" style="height: 300px;"></div>
                                </div>
                            </div>
                            <!-- box end -->
                        </div>
                    <!-- col md 6 end first -->
                    </div>
                    <!-- iamge start first -->
                    <div class="row">
                    <div class="col-md-6">
                        <div class="box box-primary">
                            <div class="box-header with-border">
                                <i class="fa fa-bar-chart-o"></i>
                                <h3 class="box-title">show image</h3>
                            </div>
                            <!-- box header end -->
                            <div class="box-body">
                                <div id="show_image">
                                    <img style="height:300px"></img>
                                </div>
                            </div>  
                            <!-- box body end -->
                        </div>
                        <!-- box end -->
                    </div>
                    <!-- col md 6 end image end  first -->
                    <!-- controller start -->
                    <div class="col-md-6">
                        <div class="box box-primary">
                            <div class="box-header with-border">
                                <i class="fa fa-bar-chart-o"></i>
                                <h3 class="box-title">control panel</h3>
                            </div>
                            <!-- box header end -->
                            <div class="box-body">
                                <div id="controller"></div>
                            </div>
                            <!-- box body end -->
                        </div>
                    </div>
                    <!-- col md 6 end controller end first -->
                    </div>
                    </div>
                    <!-- row end -->
            </div>
        <% include ../../partials/footer.ejs %>
            <div class="control-sidebar-bg"></div>
        </div>
        <!-- /.content-wrapper -->
      
            <!-- /.control-sidebar -->
            <!-- Add the sidebar's background. This div must be placed
       immediately after the control sidebar -->
    </div>
    
    <% include ../../partials/footer_graph_javascript.ejs %>
  </body>
  <script>
$(function(){

    /*
     * LINE CHART
     * ----------
     */
    //LINE randomly generated data

    var sin = [], cos = [];
    for (var i = 0; i < 14; i += 0.5) {
      sin.push([i, Math.sin(i)]);
      cos.push([i, Math.cos(i)]);
    }
    var line_data1 = {
      data: sin,
      color: "#3c8dbc"
    };
    var line_data2 = {
      data: cos,
      color: "#00c0ef"
    };
    $.plot("#line-chart", [line_data1, line_data2], {
      grid: {
        hoverable: true,
        borderColor: "#f3f3f3",
        borderWidth: 1,
        tickColor: "#f3f3f3"
      },
      series: {
        shadowSize: 0,
        lines: {
          show: true
        },
        points: {
          show: true
        }
      },
      lines: {
        fill: false,
        color: ["#3c8dbc", "#f56954"]
      },
      yaxis: {
        show: true,
      },
      xaxis: {
        show: true
      }
    });
    //Initialize tooltip on hover
    $('<div class="tooltip-inner" id="line-chart-tooltip"></div>').css({
      position: "absolute",
      display: "none",
      opacity: 0.8
    }).appendTo("body");
    $("#line-chart").bind("plothover", function (event, pos, item) {

      if (item) {
        var x = item.datapoint[0].toFixed(2),
            y = item.datapoint[1].toFixed(2);

        $("#line-chart-tooltip").html(item.series.label + " of " + x + " = " + y)
            .css({top: item.pageY + 5, left: item.pageX + 5})
            .fadeIn(200);
      } else {
        $("#line-chart-tooltip").hide();
      }

    });
    /* END LINE CHART */

    var get_Data = function(){
        $.ajax({
            type:"GET",
            url:"",
            dtaType:"json",
            error:function(){
                var ajax_data;
                ajax_data = null;
            },
            success:function(data){
                var chart_data;
                //ajax_data = JSON.stringify(data);
                chart_data = data;
                var get_data = chart_data;
                
            }
        })
    }

    var get_image = function(){
        $.ajax({
            type:"GET",
            url:"",
            dataType:"json",
            error:function(){
                var ajax_path;
                ajax_path = "/images/failed/failed.jpg";
                
                $("#show_image").find("img").attr("src", ajax_path);
            },
            success:function(data){
                var ajax_data = data;
                var img_path;
                var d = new Data(ajax_data.createdAt);
                var dateStr = d.getFullYear() + "/" + (d.getMonth() + 1) + "/" + d.getDate() + " " + d.getHours() + ":" + d.getMinutes();
                if (ajax_data.createdAt == "") dateStr = "";
                img_path = '/images/' + ajax_data.si_serial + '/' + ajax_data.si_path + '/' + ajax_data.si_filename;
                $("#camera-info").find("img").attr("src", img_path);
            }
        });
    }
    get_image();
    setInterval("get_image()", 1000 * 60*30);

});
  </script>
</html>
